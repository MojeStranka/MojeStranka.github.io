<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<style>

	h1 {
        text-align: center;
        font-family: Banschrift;
        font-size: 4vh;
 	}
	#body {
		margin-left: auto;
		margin-right: auto;
	}
	.div {
		margin-right: auto;
		margin-left: auto;
		border: 2px solid black;
		width: 100%;
		height: 20%;
        background: skyblue;
	}
	#canvas {
		margin-right: auto;
		margin-left: auto;
		border: 2px solid black;
		width: 100%;
		height: 50%;
	}
	#flexbox {
		display: flex;
  		flex-wrap: wrap;
		border: 2px solid black;
		width: 100%;
		height: 10%;
	}
	.button {
		width: 50%;
		height: 100%;
        font-size: 4vh;
	}


	@media screen and (height <= 400px) {

        #canvas {
            position: absolute;
            float: left;
            width: 40%;
            height: 90%;
            }

        .div {
            float: right;
            border: 2px solid black;
            width: 50%;
            height: auto;
            background: skyblue;
            }

        #flexbox {
            width: 50%;
            height: auto;
        }

        .button {
            height: auto;
            width: 50%;
            font-size: 9vh;
        }
        
        h1 {
            font-size: 9vh;
        }
    }
	</style>
</head>


<body id="body">
	<div class="div">
		<h1>
            Scóre: 
            <span id="score">
                0
            </span>
        </h1>
	</div>
	<canvas id="canvas">

    </canvas>
	<div class="div">
		<h1 id="otazka">Otazka</h1>
		<h1>Zbývající čas: <span id="seconds">10</span> vteřin</h1>
	</div>
	<div class="div" id="flexbox">
		<button class="button" id="levyButton" onclick="levyButton()">
			<h1>
                Odpoved1
            </h1>
		</button>
		<button class="button" id="pravyButton" onclick="pravyButton()">
			<h1>
                Odpoved2
            </h1>
		</button>
	</div>
</body>


<script type="text/javascript">
    // responzivní interface
	var bodyEl = document.getElementById("body");
	bodyEl.style.width = 0.9*window.innerWidth + "px";
	bodyEl.style.height = 0.9*window.innerHeight + "px";
</script>


<script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js">
</script>


<script>
  var programCode = function(processingInstance) {
    with (processingInstance) {
    // nastavení poměru stran canvasu 
    var canvasWidth = window.innerWidth;
    var canvasHeight = window.innerHeight/2;
    // regulace rozměrů (kvůli hratelnosti)
    if (canvasHeight <= 200) {
        canvasWidth = canvasWidth * 1.125;
        canvasHeight = canvasHeight * 5;
    } else if (canvasHeight > 150) {
        var k = canvasWidth/canvasHeight;
        while (canvasHeight < 500) {
            canvasHeight = canvasHeight + 30;
            canvasWidth = canvasWidth + 30*k;
        }
    } 

    size(canvasWidth,canvasHeight);
    frameRate(50);
        
        // konstruktor nové třídy (postava)
        var Character = function(x, y) {
          this.x = x;
          this.y = y;
        };

        // přidání vlastnosti "draw" 
        Character.prototype.draw = function() {
            this.y = constrain(this.y, 0, height*0.85 - 50);
            fill(255, 213, 0);
            rect(this.x, this.y, 50, 50);
            fill(255, 255, 255);
            rect(this.x + 30, this.y + 5, 15, 15);
            rect(this.x + 5, this.y + 5, 15, 15);
            fill(0, 0, 0);
            rect(this.x + 35, this.y + 10, 4, 4);
            rect(this.x + 10, this.y + 10, 4, 4);
            fill(255, 0, 0);
            rect(this.x + 5, this.y + 30, 40, 12);
            fill(255, 255, 255);
            rect(this.x + 20, this.y + 30, 5, 5);
            rect(this.x + 25, this.y + 30, 5, 5);
        };

        // přidání vlastnosti "jump"
        Character.prototype.jump = function() {
            this.y -= 1 * 5.5;
        };

        // přidání vlastnosti "fall"
        Character.prototype.fall = function() {
            this.y += 1 * 1.5;
        };

        // přidání vlastnosti "crash"
        // argument "obstacle" deklarován níže
        Character.prototype.crash = function(obstacle) {
            if( // naraz do vrchni prekazky kolmo
                ((this.x + 50 === obstacle.x) && (this.y <= obstacle.height))||
                // naraz do vrchni prekazky
                ((this.x + 50 >= obstacle.x) && (this.x <= obstacle.x + 40) && 
                (this.y <= obstacle.height))||
                // naraz do spodni prekazky kolmo
                ((this.x + 50 === obstacle.x) && (this.y + 50 >= height*0.85 + obstacle.height))||
                // naraz do spodni prekazky
                ((this.x + 50 >= obstacle.x) && (this.x <= obstacle.x + 40) && 
                (this.y + 50 >= height*0.85 + obstacle.height))) 
            {
                window.location.reload();
            }
        };

        // konstruktor nové třídy (překážky)
        var Obstacle = function(x, y, height) {
            this.x = x;
            this.y = y;
            this.height = height;
        };

        // přidání vlastnosti "draw"
        Obstacle.prototype.draw = function() {
            fill(130, 30, 176);
            rect(this.x, this.y, 40, this.height);
            if (this.height > 0){
                rect(this.x - 3, this.height - 10, 45, 10);
                rect(this.x - 3, this.y, 45, 10);
            }
            else {
                rect(this.x - 3, this.height + height*0.85, 45, 10);
                rect(this.x - 3, this.y - 10, 45, 10);
            }
        };

        // deklarace objektu herni postavy
        var Bob = new Character(40, 280);

        // deklarace pole (velikosti) pro trávu
        var grass = [];
        for (var i = 0; i < (width/20) + 1; i++) {
            grass.push(i*20);
        }
        
        // deklarace pole překážek
        var obstacle = [];
        for (var i = 0; i < 95; i++) {  
            // nahodna velikost prekazek
            var delka = random(height*0.2, height*0.5);
            // horni prekazky
            obstacle.push(new Obstacle(i * 150 + 400, 0, delka));
            // dolni prekazky
            obstacle.push(new Obstacle(i * 150 + 400, height*0.85, delka - height*0.5));
        }


    // hlavní kreslící funkce, frekvence 50fps

        // proměnná Count slouží k plynulým pohybým 
        var Count = 0;
        draw = function() {
            
            // obloha
            background(227, 254, 255);
            // mrak
            fill(255, 255, 255);
            ellipse(200, 100, 50, 50);
            ellipse(235, 100, 50, 50);
            ellipse(270, 100, 50, 50);
            ellipse(305, 100, 50, 50);
            noStroke();
            rect(206, 82, 88, 36);
            stroke(0, 0, 0);
            // slunce
            fill(255, 250, 94);
            ellipse(0, 0, 200, 200);
            // země
            fill(130, 79, 43);
            rect(0, height*0.85, width, height*0.15);
            
            for (var i = 0; i < grass.length; i++) {
                fill(67, 186, 79);
                rect(grass[i], height*0.85, 20, 20);
                grass[i] -= 2;
                if (grass[i] <= -20) {grass[i] = width;}
            }
            
            for (var i = 0; i < obstacle.length; i++) {
                obstacle[i].draw();
                obstacle[i].x -= 2;
                Bob.crash(obstacle[i]);
            }

            // zjištění vstupu z myši
            mouseClicked = function() {
                Count = 10;
            };
            // zjištění vstupu z klávesnice
            keyPressed = function() {
                Count = 10;
            };
            // pro plynulý skok
            if (Count > 0) {
                Bob.jump();
            }

            Count = Count - 1;
            Bob.fall();
            Bob.draw();
        };


    }};
    var canvas = document.getElementById("canvas"); 


    // deklarace časovače
    var seconds = document.getElementById("seconds");
    var currentTime;
    // funkce časovače při každé implementaci sníží čas o "1"
    var timeOut = function() {
                currentTime = parseFloat(seconds.textContent);
                seconds.textContent = currentTime - 1;
                if (seconds.textContent == "-1") {
                    alert('Nestihl jsi odpovědět, konečné score: ' + scoreEl.textContent);
                    window.location.reload();
                }
            }
    // metoda pro volání funkce timeOut každých 1000ms
    var secondsTimer = window.setInterval(timeOut, 1000);


    // deklarace skóre (podobné jako časovač)
    var scoreEl = document.getElementById("score");
    var currentScore;
    // funkce scoreUp při každé implementaci zvýší skóre o "1"
    var scoreUp = function() {
        currentScore = parseFloat(scoreEl.textContent);
        scoreEl.textContent = currentScore + 1;
    };
    // metoda pro volání funkce scoreUp každých 100ms
    var scoreTimer = window.setInterval(scoreUp, 100);


    // deklarace otázek
    var otazkaEl = document.getElementById("otazka");
    var pravyButtonEl = document.getElementById("pravyButton");
    var levyButtonEl = document.getElementById("levyButton");
    var spravnyButton;

    var generovaniOtazek = function(Button) {
        // náhodně generované operandy (ineteger)
        var cislo1 = Math.round(Math.random(1)*30);
        var cislo2 = Math.round(Math.random(2)*25);
        // náhodně generovaný chybný faktor
        var chyba = Math.round(Math.random(2)*6.9);
        // náhodný výběr otázek
        var i = Math.round(Math.random(0)*4);

        // seřazení čísel (pro lehčí výpočty)
        if (cislo2 > cislo1) {
            var pom = cislo2;
            cislo2 = cislo1;
            cislo1 = pom;
        };

        // deklarace pole otázek
        var poleOtazek = [
            cislo1+" + "+cislo2, 
            cislo1+" - "+cislo2, 
            cislo1+" * "+cislo2, 
            cislo1+" mod "+cislo2, 
            cislo1+"^2"
        ];

        // deklarace pole správných odpovědí
        var spravnaOdpoved = [
            cislo1+cislo2,
            cislo1-cislo2, 
            cislo1*cislo2, 
            Math.round(cislo1/cislo2), 
            cislo1*cislo1
        ];

        // deklarace pole špatných odpovědí
        var spatnaOdpoved = [
            cislo1+cislo2+chyba,
            cislo1-cislo2-chyba,
            (cislo1*cislo2)-chyba,
            Math.round(cislo1/cislo2)+chyba,
            (cislo1*cislo1)+chyba
        ]; 

        // zjištění zda se vybrala správná odpověď
        if (Button === spravnyButton) {
            seconds.textContent = "10";
            spravnyButton = Math.round(Math.random(0)*1);
            otazkaEl.textContent = poleOtazek[i];
            if (spravnyButton == 0) {
                levyButtonEl.textContent = spravnaOdpoved[i];
                pravyButtonEl.textContent = spatnaOdpoved[i];
            }
            if (spravnyButton == 1) {
                levyButtonEl.textContent = spatnaOdpoved[i];
                pravyButtonEl.textContent = spravnaOdpoved[i];
            }
        } else {
            alert('Špatná odpověď, konečné score: ' + scoreEl.textContent);
            window.location.reload();
        }
    }

    // "nastartování" generátoru otázek 
    spravnyButton = 1;
    generovaniOtazek(1);

    // funkce levého tlačítka (Button = 0)
    var levyButton = function() {
        generovaniOtazek(0);
    }

    // funkce pravého tlačítka (Button = 1)
    var pravyButton = function() {
        generovaniOtazek(1);
    }
    
    var processingInstance = new Processing(canvas, programCode); 
  </script> 


</html>
